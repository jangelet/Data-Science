import matplotlib.pyplot as plt
import urllib
import re

prefix = "http://www.wunderground.com/history/airport/KLGA/2017/01/"
suffix = "/DailyHistory"
days = []                #Sets up a list to store days         
minTempF = []            #Sets up a list to store min values
minTempAvg = 0


#scraping Weather Underground for data
def getTempFromWeb(kind,url):
    
     page = urllib.request.urlopen(url)
     lines = page.readlines()
     for i in range(len(lines)):
          if lines[i].decode("utf8").find(kind+" Temperature") >= 0:
               m = i
               break
     searchObj = re.search('\d+', lines[m+2].decode("utf8"))
     return int(searchObj.group(0))

#calculating rolling averages

for day in range(1, 31):             
    days.append(day)                  
    url = prefix+str(day)+suffix      
    Min = getTempFromWeb("Min", url)  
    minTempF.append(Min)             
    # print(minTempF)
    

DayAvg = [] 
placehldr = 0

#calculating rolling average
for i in range (1,31):
    
    temp = (minTempF[i-1] + placehldr)/(i+1)
    DayAvg.append(temp)
    placehldr = DayAvg[i-1] + placehldr
    # print(DayAvg[i-1])

#graph
plt.scatter(days, DayAvg, label="Rolling Average", c = "blue", s=100)

plt.title("Daily Minimum Temperature Rolling Average of January 2017")
plt.xlabel('Date (January 2017)')
plt.ylabel('Rolling Min. Avg. Temperature (Fahrenheit)')
plt.show()
